Раcсмотрим решение виртуализации для linux машин на базе архитектуры x86 - KVM. Сам kvm это совокупность это модули процессара kvm.co и является базовыим сервисом виртуализации + 2 модуля, которые подгружаются взависимости от типа процессора kvm-amd.ko, kvm-intel.ko. 

Модифицированный Qemu (программа - эмулятор, работающая в пользовательском пространстве) использует KVM для хардварной виртуализации через интерфейс /dev/kvm. Qemu-kvm запускает программу под общим обозначением гипервизор. Которая умеет, имеет возможность работать в так называемом "привилегированным режиме", а именно ring1 (hypervisor mode). Посути этот гипервизор является неким микроядром, которое умеет разпределять системные ресурсы (главным образом процессорное время, память) между "гостевыми ОС" - виртуальными машинами. Гостевые "OC" запускаются в отдельных "posix thread-ах". На каждый виртульный CPU - 1 тред, тоесть 1 VM c двумя CPU будет выглядеть как 2 "posix threada" на хост системе.

Qemu является эмулятором, и может эмулировать различные архитектуры, даже если они отличаются от хост системы. Например выполнять VM c архитектурой ARM, MIPS на хосте x86, либо PPC mac. Отсюда следует что можно запускать Qemu-kvm без поддержки процессорного модуля. Но все это будет работать гораздо медленней, с большим "оверхедом". Т.к. потребуются ресурсы на трянсляцию инструкций процессора написанного для одной архитектуры в другую.

Использовать возможности хардварной виртуализации позволяет поддержка процессора. Например процессоры Intel используют технологию виртуализации VT (VT-x, VT-i).  Кодовое название ""Vanderpool"". А также AMD-SVM.
Идея самой виртуализации не является новой и происходит со времен 386 процессоров, когда  существовал некий режим V86 (Virtual 8086), который позволял создавать 8086 виртуальные машины, которые выполняли DOS-
based программы. Каждая VM ""думала"", что  исполняется на полностью независимом компьютере.

Процессор поддерживающий виртуализацию имеет набор дополнительных инструкций, которые позволяют гипервизору (он же VVM - Virtual Machine Monitor) легко управлять ресурсами минуя програмную виртуализацию, тем самым увеличивая производительность (которую можно сопоставить с производительностью OS на отдельном железе).

VT-d является дополнением к Vanderpool-у, и является технологией виртуализации ввода-вывода  и позволяет пробрасывать подключаемые устройства на PCI шине в VM. Для этого дела используется специальное усторойство на чипсетах материнки, называемое IOMMU. Этот устройство, вернее блок, управляет памятью (транслирует в физические из вирт.) которая предоставляется подключаемому к шине устройтсву, аналогично MMU процессора, только эти устройства имеют доступ к памяти минуя процессор и имеют возмжность проводить DMA(DRIECT MEMERY ACCESS) операции как по физическим, так и виртуальным адресам.

Каждое виртуальное ядро использует отдельно физическое ядро на хост машине..Тоесть нельзя обьединить два физических ядра в одно виртуальное, но можно использовать одно физическое ядро двумя виртуальнымим, если это две разные VM. Одной VM можно присвоить любое кол-во виртуальных ядер не превышающее кол-во физических.. 

